<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>企业注册</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link rel="shortcut icon" href="favicon.ico"> <link href="{% static 'css/bootstrap.min.css' %}?v=3.3.6" rel="stylesheet">
    <link href="{% static 'css/font-awesome.css' %}?v=4.4.0" rel="stylesheet">
    <link href="{% static 'css/plugins/iCheck/custom.css' %}" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}?v=4.1.0" rel="stylesheet">
    <script>if(window.top !== window.self){ window.top.location = window.location;}</script>

</head>

<body class="gray-bg">

    <div class="middle-box text-center loginscreen   animated fadeInDown">
        <div>
            <div>

                <h1 class="logo-name">NFC</h1>

            </div>
            <h3>欢迎注册 新未来物资采购平台</h3>
            <p>创建一个新账户</p>
                <div class="form-group">
                    <input type="text" id="corporate_name" class="form-control" placeholder="请输入企业名称" required="">
                </div>
                <div class="form-group">
                    <input type="text" id="corporate_code" class="form-control" placeholder="请输入统一信用代码" required="">
                </div>
                <div class="form-group">
                    <input type="password" id="password" class="form-control" placeholder="请输入密码" required="">
                </div>
                <div class="form-group">
                    <input type="password" id="cpassword" class="form-control" placeholder="请再次输入密码" required="">
                </div>
            <hr/>
                <div class="form-group">
                    <input type="text" id="corporate_contacts" class="form-control" placeholder="请输入联系人" required="">
                </div>
                <div class="form-group">
                    <input type="text" id="corporate_phone" class="form-control" placeholder="请输入联系电话" required="">
                </div>
                <button type="submit" class="btn btn-primary block full-width m-b"  onclick="postLoginRequest()">注 册</button>

                <p class="text-muted text-center"><small>已经有账户了？</small><a href="/login/">点此登录</a>
                </p>

        </div>
    </div>

    <!-- 全局js -->
    <script src="{% static 'js/jquery.min.js' %}?v=2.1.4"></script>
    <script src="{% static 'js/bootstrap.min.js' %}?v=3.3.6"></script>
    <!-- iCheck -->
    <script src="{% static 'js/plugins/iCheck/icheck.min.js' %}"></script>
    <script>
        $(document).ready(function () {
            $('.i-checks').iCheck({
                checkboxClass: 'icheckbox_square-green',
                radioClass: 'iradio_square-green',
            });
        });
    </script>
<script>
	function postLoginRequest() {
		console.log("login");
		var corporate_name = $("#corporate_name").val(),
		corporate_code = $("#corporate_code").val(),
		n = $("#password").val(),
		corporate_contacts = $("#corporate_contacts").val(),
		corporate_phone = $("#corporate_phone").val();
		0 !== corporate_code.length ? 0 !== corporate_name.length  ? 0 !== n.length ? $.ajax({
			url: "/api/user/adduser",
			type: "POST",
			data: "corporate_name=" + corporate_name + "&corporate_code=" + corporate_code + "&password=" + n + "&corporate_contacts=" + corporate_contacts + "&corporate_phone=" + corporate_phone,
			success: function(e, n, t) {
				0 === e.ret ? window.location.href = "/mgr/index.html": (alert("登录失败 : " + e.msg), $("#password").val(""))
			},
			error: function(e, n, t) {
				alert("错误: " + e.status + t)
			}
		}) : alert("请输入密码") : alert("请输入用户名")
	}
	function curTimestamp() {
		var e = (new Date).getTime();
		return Math.floor(e / 1e3)
	}
	var lastSendReqTime = 0;
	function on_return(e) {
		if (13 == e) {
			var n = curTimestamp();
			if (n - window.lastSendReqTime < 5) return;
			window.lastSendReqTime = n,
			postLoginRequest()
		}
	}
	document.onkeydown = function(e) {
		on_return(window.event ? window.event.keyCode: e.which)
	}
</script>
    
    

</body>

</html>
