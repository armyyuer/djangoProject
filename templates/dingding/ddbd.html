<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>绑定钉钉账号</title>

    <link rel="shortcut icon" href="{% static 'favicon.ico' %}">
    <link href="{% static 'css/bootstrap.min.css' %}?v=3.3.6" rel="stylesheet">
    <link href="{% static 'css/font-awesome.min.css' %}?v=4.4.0" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}?v=4.1.0" rel="stylesheet">
<script src="https://g.alicdn.com/dingding/dingtalk-jsapi/2.7.13/dingtalk.open.js"></script>

<script type="text/javascript">
    function getPar(par){
            //获取当前URL
            var local_url = document.location.href;
            //获取要取得的get参数位置
            var get = local_url.indexOf(par +"=");
            if(get == -1){
                return false;
            }
            //截取字符串
            var get_par = local_url.slice(par.length + get + 1);
            //判断截取后的字符串是否还有其他get参数
            var nextPar = get_par.indexOf("&");
            if(nextPar != -1){
                get_par = get_par.slice(0, nextPar);
            }
            return get_par;
          }
    dd.ready(function() {
            var uid=getPar('uid')
            dd.runtime.permission.requestAuthCode({
                corpId : "ding3fb6ab0d24852531",
                onSuccess : function(result) {
                    var code = result.code;
                    //alert('获取成功，你的免登code为：' + code);　　　　　　　　　　　　//将code 发往后台处理
                    location.href="/dingding/DDbdu/?code=" + code +"&uid=" + uid;

                },
                onFail : function(err) {
                    alert('出错了, 你获取了一个自定义错误' + err);
                }
            });

        });

</script>
</head>
<body  class="gray-bg">

    <div class="wrapper wrapper-content  animated fadeInRight">
        <div class="row">
            <div class="ibox-content">
                            <div class="spiner-example">
                                <div class="sk-spinner sk-spinner-wave">
                                    <div class="sk-rect1"></div>
                                    <div class="sk-rect2"></div>
                                    <div class="sk-rect3"></div>
                                    <div class="sk-rect4"></div>
                                    <div class="sk-rect5"></div>
                                </div>
                            </div>
            </div>
        </div>
    </div>

    <!-- 全局js -->
    <script src="{% static 'js/jquery.min.js' %}?v=2.1.4"></script>
    <script src="{% static 'js/bootstrap.min.js' %}?v=3.3.6"></script>

    <!-- 自定义js -->
    <script src="{% static 'js/content.js' %}?v=1.0.0"></script>
</body>

</html>